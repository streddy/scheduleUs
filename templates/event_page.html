{% extends 'base.html' %}

{% block title %}Event_Page{% endblock %}
{% block content %}
<!DOCTYPE html>

<html lang="en-US">
<head>
<title>ScheduleUs - Event Page </title>
{% load leaflet_tags %}
{% leaflet_js %}
{% leaflet_css %}
</head>

<body>
<div class="header-right">
    {% if user.is_authenticated %}
        <p>Welcome {{ user.get_username }}</p> &nbsp;
    {% else %}
        <p>Who dis?</p> &nbsp;
    {% endif %}

    <a href={% url 'logout' %}>Logout</a> &nbsp;
    <a href={% url 'contact' %}>Contact</a> &nbsp;
    <a href={% url 'about' %}>About</a> &nbsp;
    <a href={% url 'dashboard'%}> Dashboard </a> &nbsp;
</div>
<h2> Event Page </h2>
<hr>
<p> Event Details </p>
<hr>
<p> Name : {{event.name}} </p>
<p> Organizer : {{event.organizer.username}}</p>

<div>
    <p> Location: </p>
    {% leaflet_map "event_map" callback="map_init" %}
</div>
<script type="text/javascript">
    function map_init(map, options) {
        // get point lat and lon
        var lon = "{{ event.location.x }}";
        var lat = "{{ event.location.y }}";
        // zoom to point & add it to map
        map.setView([lat, lon], 17);
        L.marker([lat, lon]).addTo(map);
    }
</script>

<p> Event Description : {{event.description}}</p>
{% if event.is_public %}
    <p>This is a public event</p>
{% else %}
    <p>This is a private event</p>
{% endif %}
<br><br>
{% if event.organizer == user %}
    <form action = "{% url 'event_confirm_delete' event.pk %}" method = "post">{% csrf_token %}
      <p> Do you want to delete {{event.name}}?</p>
      <button type = "submit">Delete</button>
    </form>
    <br><br>
    <form action = "{% url 'event_update' event.pk %}" method = "post">{% csrf_token %}
      <p> Do you want to update {{event.name}}?</p>
      <button type = "submit">Update</button>
    </form>
{% endif %}
<br><br>
</body>
</html>
{% endblock %}
